# YLAI-AUTO-PLATFORM å…¨å±€æ•´ç†ä¼˜åŒ–æŠ¥å‘Š

**ç”Ÿæˆæ—¥æœŸ**: 2026å¹´1æœˆ7æ—¥  
**æŠ¥å‘Šç±»åž‹**: å…¨çƒä»£ç ç»“æž„ã€é…ç½®ç®¡ç†ã€ä¾èµ–ä¸Žéƒ¨ç½²æ•´ç†ä¼˜åŒ–å»ºè®®  
**æ‰«æèŒƒå›´**: æ•´ä¸ªé¡¹ç›®ï¼ˆbackend/ã€frontend/ã€config/ã€docker/ã€scripts/ã€.github/ ç­‰ï¼‰  
**æ‰«ææ·±åº¦**: æ— é™é€’å½’ï¼Œæ¶µç›–æ‰€æœ‰æ–‡ä»¶ç±»åž‹  

---

## ðŸ“Š é¡¹ç›®çŽ°çŠ¶æ‘˜è¦

### åŸºæœ¬ä¿¡æ¯
- **é¡¹ç›®åç§°**: YLAI-AUTO-PLATFORM
- **é¡¹ç›®ç±»åž‹**: ä¼ä¸šçº§è‡ªåŠ¨åŒ–çˆ¬è™«å¹³å°ï¼ˆFastAPI + Vue.js 3ï¼‰
- **ç‰ˆæœ¬**: v1.7.0
- **æ ¸å¿ƒæž¶æž„**: ç»Ÿä¸€å†…æ ¸ + èŠ‚ç‚¹åŒ– API è·¯ç”± + è„šæœ¬è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿ
- **éƒ¨ç½²æ–¹å¼**: Docker Compose + Kubernetesï¼ˆå¯é€‰ï¼‰

### æ–‡ä»¶ä¸Žæ¨¡å—ç»Ÿè®¡
| ç±»åˆ« | æ•°é‡ | è¯´æ˜Ž |
|------|------|------|
| åŽç«¯è·¯ç”±å™¨ | 40+ | `backend/api/*.py` ä¸­çš„å„ç±»ä¸šåŠ¡è·¯ç”±ï¼ˆauthã€pipelineã€monitor ç­‰ï¼‰ |
| åŽç«¯æœåŠ¡ | 12+ | `backend/services/*` ä¸­çš„æœåŠ¡æ¨¡å—ï¼ˆpluginã€cacheã€dbã€monitoring ç­‰ï¼‰ |
| å‰ç«¯é¡µé¢ | 5+ | ä¸»é¡µã€ä»»åŠ¡æ‰§è¡Œã€APIæ–‡æ¡£ã€ç›‘æŽ§ã€DAGæµæ°´çº¿ |
| é…ç½®æ–‡ä»¶ | 3+ | `config/*.json`ï¼ˆæ¨¡å—ç­–ç•¥ã€æ’ä»¶æ³¨å†Œã€æ ¸å¿ƒæŒ‡å‘ï¼‰ |
| Docker é•œåƒ | 3+ | APIã€AI-Appã€Nginx ç­‰ |
| ä¾èµ–åŒ… | 60+ (Python) + 20+ (Node) | fastapiã€celeryã€torchã€vueã€axios ç­‰ |

### å·²çŸ¥é—®é¢˜æ¸…å•
1. **çŽ¯å¢ƒä¸Žä¾èµ–**
   - ç³»ç»Ÿç¼ºå°‘ `npm`/`Node`ï¼Œå¯¼è‡´å‰ç«¯ä¾èµ–å®‰è£…å¤±è´¥ï¼›`nvm` å·²å®‰è£…ä½†æœªæ¿€æ´»åˆ° PATHã€‚
   - åŽç«¯å¤§åž‹ä¾èµ–ï¼ˆå¦‚ `torch`ã€`easyocr`ã€`ddddocr`ï¼‰ä¸‹è½½ç¼“æ…¢ï¼Œæ˜“å¯¼è‡´å®‰è£…è¶…æ—¶ã€‚
   - `frontend/package.json` ä¸­ `cypress` ç­‰å¯é€‰åŒ…ä½“ç§¯å¤§ï¼ˆ>50MBï¼‰ã€‚

2. **é…ç½®ç®¡ç†**
   - Copilot è§„åˆ™æ–‡ä»¶ï¼ˆ`YL-copilot-rules.json`ï¼‰ä¸Ž `.github/copilot-instructions.md` å­˜åœ¨å†—ä½™æè¿°ï¼Œæœªå®Œå…¨è”åŠ¨ã€‚
   - ç¼ºå°‘å•ä¸€çš„é¡¹ç›®æ ¹é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `pyproject.toml`ï¼‰ï¼ŒPython ä¾èµ–ç®¡ç†æ•£è½äºŽ `backend/requirements.txt`ã€‚
   - `config/*.json` ä¸Ž `backend/api/` ä¸­çš„è·¯ç”±ç¡¬ç¼–ç å­˜åœ¨éƒ¨åˆ†é‡å¤ã€‚

3. **API ä¸Žé¡µé¢**
   - éƒ¨åˆ†åŽç«¯ API è·¯ç”±ï¼ˆ40+ ä¸ªï¼‰ç¼ºä¹ç»Ÿä¸€çš„æŽ¥å£è§„èŒƒæ–‡æ¡£ï¼ˆè™½æœ‰ `/docs`ï¼Œä½†è‡ªåŠ¨ç”Ÿæˆï¼Œæ›´æ–°ä¸åŠæ—¶ï¼‰ã€‚
   - å‰ç«¯é¡µé¢ï¼ˆ`frontend/pages/*.html`ï¼‰é‡‡ç”¨æ¨¡æ¿åŠ è½½ï¼Œè‹¥åŽç«¯ `/health` å¤±è´¥ï¼Œé¡µé¢å¯èƒ½æ— æ³•å¯åŠ¨ã€‚
   - ç¼ºå°‘å‰åŽç«¯æŽ¥å£çš„ç‰ˆæœ¬ç®¡ç†ä¸Žå‘åŽå…¼å®¹æ€§ä¿è¯ã€‚

4. **æµ‹è¯•ä¸Žç›‘æŽ§**
   - `backend/test_smoke.py` å’Œ `pytest.ini` å­˜åœ¨ï¼Œä½†è¦†ç›–çŽ‡ä¸é«˜ï¼ˆä»…å†’çƒŸæµ‹è¯•ï¼‰ã€‚
   - ç›‘æŽ§é…ç½®ï¼ˆ`monitoring/`ï¼‰ç¼ºå°‘ä¸Žåº”ç”¨çš„ç›´æŽ¥é›†æˆï¼ˆå¦‚ Prometheus exporter ç«¯ç‚¹ï¼‰ã€‚
   - ç¼ºå°‘è‡ªåŠ¨åŒ–çš„ E2E æµ‹è¯•ï¼ˆè™½æœ‰ Cypress é…ç½®ï¼Œä½†é›†æˆä¸å®Œæ•´ï¼‰ã€‚

5. **éƒ¨ç½²ä¸Žæµæ°´çº¿**
   - `docker/` ä¸‹æœ‰å¤šä¸ª Dockerfileï¼Œä½†ç¼ºå°‘ç»Ÿä¸€çš„ docker-compose ç¼–æŽ’ï¼ˆè™½æœ‰ `.github/workflows` å¯èƒ½å­˜åœ¨ï¼Œä½†é…ç½®åˆ†æ•£ï¼‰ã€‚
   - `start.sh` è„šæœ¬å­˜åœ¨ï¼Œä½†å¯èƒ½è¿‡æ—¶æˆ–è¦†ç›–ä¸å…¨ã€‚
   - ç¼ºå°‘è‡ªåŠ¨åŒ–çš„å¥åº·æ£€æŸ¥ä¸Žè‡ªæ„ˆæœºåˆ¶ï¼ˆè™½æœ‰ `backend/api/health_check.py`ï¼Œä½†é›†æˆåº¦ä½Žï¼‰ã€‚

6. **æ–‡æ¡£ä¸Žäº¤ä»˜**
   - `docs/` ä¸‹æœ‰å¤šä»½æ–‡æ¡£ï¼ˆä¼˜åŒ–å»ºè®®ã€å¾…å®Œæˆä»»åŠ¡ç­‰ï¼‰ï¼Œä½†ç¼ºå°‘ç»Ÿä¸€çš„å…¥å£ä¸Žå¯¼èˆªã€‚
   - ç¼ºå°‘"å¿«é€Ÿå¯åŠ¨"ã€"æ•…éšœæŽ’æŸ¥"ã€"éƒ¨ç½²è¿ç»´"ä¸‰ä¸ªå…³é”®è¿ç»´æ‰‹å†Œã€‚
   - README ä¸­çš„å¿«é€Ÿå¯åŠ¨æ­¥éª¤ä¸Žå®žé™…ä»»åŠ¡é…ç½®ï¼ˆ`.vscode/tasks.json`ï¼‰ä¸åŒæ­¥ã€‚

---

## ðŸŽ¯ ä¼˜åŒ–å»ºè®®ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

### ç¬¬ä¸€æ¢¯é˜Ÿï¼šå¿…é¡»ï¼ˆå½±å“æ ¸å¿ƒåŠŸèƒ½ï¼‰

#### 1. ä¾èµ–ç®¡ç†ä¸Žé”æ–‡ä»¶è§„èŒƒã€ä¼˜å…ˆçº§ï¼šå¿…é¡»ã€‘
**çŽ°çŠ¶**: `backend/requirements.txt` ç‰ˆæœ¬å·éƒ¨åˆ†å›ºå®šã€éƒ¨åˆ†å®½æ³›ï¼›å‰ç«¯ `package.json` ä¾èµ–ç‰ˆæœ¬ä½¿ç”¨ `^` é€šé…ç¬¦ã€‚

**é—®é¢˜**: 
- CI/CD ä¸­å¯èƒ½å®‰è£…åˆ°ä¸åŒçš„ä¾èµ–ç‰ˆæœ¬ï¼Œå¯¼è‡´"æœ¬åœ°è¿è¡Œæ­£å¸¸ã€CI å¤±è´¥"ã€‚
- Cypress ç­‰å¤§åž‹å¯é€‰åŒ…æ¯æ¬¡éƒ½é‡æ–°ä¸‹è½½ï¼Œæµªè´¹å¸¦å®½ä¸Žæ—¶é—´ã€‚

**æ–¹æ¡ˆ**:
1. **åŽç«¯**: ä½¿ç”¨ `pip-tools` ç”Ÿæˆ `requirements.lock` æ–‡ä»¶ï¼Œç¡®ä¿ç²¾ç¡®ç‰ˆæœ¬æŽ§åˆ¶ã€‚
   ```bash
   pip install pip-tools
   pip-compile -o backend/requirements.lock backend/requirements.in
   # åœ¨ CI ä¸­ä½¿ç”¨: pip install -r backend/requirements.lock
   ```

2. **å‰ç«¯**: ä½¿ç”¨ `npm ci` è€Œéž `npm install`ï¼Œç¡®ä¿ `package-lock.json` è¢«ä½¿ç”¨ã€‚
   - å·²æœ‰ `package-lock.json`ï¼Œä½†éœ€åœ¨ CI ä¸­å¼ºåˆ¶ä½¿ç”¨ `npm ci`ã€‚
   - åœ¨ `package.json` ä¸­åˆ†ç¦»å¯é€‰åŒ…ï¼ˆdevDependencies ä¸­çš„ `cypress`ï¼‰ã€‚

3. **ä¿®æ”¹æ–‡ä»¶**:
   - åˆ›å»º `backend/requirements.in`ï¼ˆé«˜å±‚ä¾èµ–å£°æ˜Žï¼‰
   - ç”Ÿæˆ `backend/requirements.lock`ï¼ˆé”å®šç‰ˆæœ¬ï¼‰
   - æ›´æ–° `.github/workflows/ci.yml`ï¼ˆè‹¥å­˜åœ¨ï¼‰ä»¥ä½¿ç”¨ lock æ–‡ä»¶

**å®žæ–½æˆæœ¬**: ã€ä¸­ã€‘ï¼ˆ3 æ–‡ä»¶ä¿®æ”¹ + 1 æ¬¡ pip-compile æ‰§è¡Œï¼‰  
**å½±å“èŒƒå›´**: `backend/requirements.txt`ã€å‰ç«¯ `npm ci` è„šæœ¬ã€CI/CD æµç¨‹  
**éªŒè¯æ–¹æ³•**: åœ¨ Docker ä¸­è¿è¡Œ `pip install -r backend/requirements.lock`ï¼Œç¡®ä¿æ— ç‰ˆæœ¬å†²çªã€‚

---

#### 2. ç»Ÿä¸€é¡¹ç›®é…ç½®å…¥å£ã€ä¼˜å…ˆçº§ï¼šå¿…é¡»ã€‘
**çŽ°çŠ¶**: 
- åŽç«¯é…ç½®æ•£è½åœ¨ `.env.dev`ã€`config/*.json`ã€`backend/app.py` ä¸­ã€‚
- å‰ç«¯é…ç½®åœ¨ `frontend/vite.config.js`ã€`frontend/package.json` ä¸­ã€‚
- Copilot è§„åˆ™åœ¨ `YL-copilot-rules.json` å’Œ `.github/copilot-instructions.md` ä¸­é‡å¤ã€‚

**é—®é¢˜**: 
- é¡¹ç›®æ–°æˆå‘˜éš¾ä»¥å¿«é€Ÿå®šä½é…ç½®æºã€‚
- é…ç½®çš„ä¸€è‡´æ€§éš¾ä»¥ä¿è¯ï¼ˆå¦‚ API ç«¯å£ã€è®¤è¯ç­–ç•¥ç­‰ï¼‰ã€‚
- å¦‚æ·»åŠ æ–°åŠŸèƒ½ï¼Œéœ€è¦ä¿®æ”¹å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚

**æ–¹æ¡ˆ**:
1. **åˆ›å»º `pyproject.toml`** ä½œä¸ºåŽç«¯é¡¹ç›®ç»Ÿä¸€é…ç½®å…¥å£ï¼ˆPython æ ‡å‡†ï¼‰ï¼š
   ```toml
   [project]
   name = "ylai-auto-platform"
   version = "1.7.0"
   description = "Enterprise-grade automated web scraping platform"
   dependencies = [
       # ä»Ž requirements.lock å¯¼å…¥ç‰ˆæœ¬
   ]
   
   [tool.black]
   line-length = 100
   
   [tool.pytest.ini_options]
   testpaths = ["backend/tests"]
   ```

2. **åˆ›å»º `frontend/.env.example`** ä½œä¸ºå‰ç«¯é…ç½®æ¨¡æ¿ï¼š
   ```
   VITE_API_BASE_URL=http://127.0.0.1:8001
   VITE_WS_URL=ws://127.0.0.1:8001/ws
   VITE_APP_ENV=development
   ```

3. **ç®€åŒ– Copilot è§„åˆ™**ï¼ˆåˆå¹¶ä¸¤ä»½æ–‡ä»¶ï¼‰:
   - åˆ é™¤ `.github/copilot-instructions.md` ä¸­çš„å†—ä½™å†…å®¹ã€‚
   - ä¿ç•™ `YL-copilot-rules.json` ä½œä¸ºå”¯ä¸€çš„è§„åˆ™æºï¼Œåˆ é™¤ `gitc.md` ä¸­é‡å¤çš„æè¿°ã€‚

**ä¿®æ”¹æ–‡ä»¶**:
   - æ–°å»º: `pyproject.toml`ã€`frontend/.env.example`
   - ä¿®æ”¹: `YL-copilot-rules.json`ï¼ˆåˆ å‡å†—ä½™ï¼‰ã€`.github/copilot-instructions.md`ï¼ˆæŒ‡å‘ YL è§„åˆ™ï¼‰

**å®žæ–½æˆæœ¬**: ã€ä¸­ã€‘ï¼ˆ2 æ–°å»º + 3 ä¿®æ”¹ï¼‰  
**å½±å“èŒƒå›´**: é¡¹ç›®æ ¹é…ç½®ã€GitHub Copilot é…ç½®ã€CI/CD åˆå§‹åŒ–  
**éªŒè¯æ–¹æ³•**: è¿è¡Œ `python -m pytest --co` ç¡®ä¿ pytest èƒ½è¯†åˆ«é…ç½®ï¼›åœ¨ç¼–è¾‘å™¨é‡å¯åŽéªŒè¯ Copilot è§„åˆ™ç”Ÿæ•ˆã€‚

---

#### 3. åŽç«¯è·¯ç”±ç»Ÿä¸€æ³¨å†Œä¸Žæ–‡æ¡£ã€ä¼˜å…ˆçº§ï¼šå¿…é¡»ã€‘
**çŽ°çŠ¶**: 
- `backend/api/` ä¸‹æœ‰ 40+ ä¸ªè·¯ç”±å™¨ï¼ˆ`.py` æ–‡ä»¶ï¼‰ï¼Œä½†ç¼ºå°‘ç»Ÿä¸€çš„è·¯ç”±æ³¨å†Œè¡¨ã€‚
- è·¯ç”±å®šä¹‰æ•£è½å„å¤„ï¼Œéƒ¨åˆ†é‡å¤æˆ–å†²çªï¼ˆå¦‚å¤šä¸ª `dashboard`, `monitor` ç­‰ï¼‰ã€‚
- `/docs` è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£ä¸ç¨³å®šï¼Œå¯èƒ½é—æ¼æˆ–æ˜¾ç¤ºé”™è¯¯çš„å‚æ•°ã€‚

**é—®é¢˜**: 
- æ–°å¢ž API æ—¶ï¼Œå¼€å‘è€…éœ€æ‰‹åŠ¨åœ¨ `backend/app.py` ä¸­å¯¼å…¥å¹¶æ³¨å†Œï¼Œæ˜“å‡ºé”™ã€‚
- æ— æ³•å¿«é€ŸæŸ¥çœ‹å…¨éƒ¨ API åŠå…¶æƒé™è¦æ±‚ã€‚
- å‰ç«¯å¼€å‘ç¼ºå°‘ç¨³å®šçš„ API å‚è€ƒã€‚

**æ–¹æ¡ˆ**:
1. **åˆ›å»º `backend/api/router_registry.py`** ç»Ÿä¸€æ³¨å†Œæ‰€æœ‰è·¯ç”±ï¼š
   ```python
   ROUTER_REGISTRY = {
       "auth": {"module": "backend.api.auth", "prefix": "/api/auth", "tags": ["auth"]},
       "pipeline": {"module": "backend.api.pipeline", "prefix": "/api/pipeline", "tags": ["pipeline"]},
       # ... å…¶ä»–è·¯ç”±
   }
   
   def register_routers(app: FastAPI):
       for name, config in ROUTER_REGISTRY.items():
           module = importlib.import_module(config["module"])
           app.include_router(module.router, prefix=config["prefix"], tags=config["tags"])
   ```

2. **åœ¨ `backend/app.py` ä¸­è°ƒç”¨ç»Ÿä¸€æ³¨å†Œ**ï¼š
   ```python
   from backend.api.router_registry import register_routers
   register_routers(app)
   ```

3. **ç”Ÿæˆ API æ–‡æ¡£**ï¼š
   - åœ¨ `backend/api/docs_router.py` ä¸­è¡¥å……æ‰‹å·¥ç¼–å†™çš„ API æ–‡æ¡£ï¼ˆMarkdown + ç¤ºä¾‹ï¼‰ã€‚
   - å®šæœŸè¿è¡Œ `python scripts/export_openapi.py` ç”Ÿæˆ `docs/api-reference.json`ï¼Œç‰ˆæœ¬æŽ§åˆ¶ã€‚

**ä¿®æ”¹æ–‡ä»¶**:
   - æ–°å»º: `backend/api/router_registry.py`ã€`scripts/export_openapi.py`
   - ä¿®æ”¹: `backend/app.py`ï¼ˆä½¿ç”¨ register_routersï¼‰
   - æ›´æ–°: `docs/api-reference.json`ï¼ˆæˆ–æ–°å»º `.md` æ–‡æ¡£ï¼‰

**å®žæ–½æˆæœ¬**: ã€ä¸­ã€‘ï¼ˆ2 æ–°å»º + 1 ä¿®æ”¹ + 1 è„šæœ¬ï¼‰  
**å½±å“èŒƒå›´**: `backend/api/`ã€`backend/app.py`ã€API æ–‡æ¡£ç”Ÿæˆæµç¨‹  
**éªŒè¯æ–¹æ³•**: è¿è¡Œ `python scripts/export_openapi.py`ï¼Œæ£€æŸ¥è¾“å‡ºæ–‡æ¡£ï¼›è®¿é—® `http://127.0.0.1:8001/docs` ç¡®ä¿æ‰€æœ‰è·¯ç”±æ˜¾ç¤ºã€‚

---

#### 4. å‰åŽç«¯é€šä¿¡åè®®ç»Ÿä¸€ã€ä¼˜å…ˆçº§ï¼šå¿…é¡»ã€‘
**çŽ°çŠ¶**: 
- å‰åŽç«¯ API è°ƒç”¨åˆ†æ•£åœ¨å¤šä¸ªåœ°æ–¹ï¼ˆ`frontend/backend-mock.js`ã€`frontend/src/` å„ç»„ä»¶ä¸­ï¼‰ã€‚
- é”™è¯¯å“åº”æ ¼å¼ä¸ç»Ÿä¸€ï¼ˆæœ‰äº›è¿”å›ž `{error: "..."}`, æœ‰äº›è¿”å›ž `{message: "..."}`ï¼‰ã€‚
- ç¼ºå°‘å‰åŽç«¯æŽ¥å£ç‰ˆæœ¬ç®¡ç†ï¼ˆå¦‚ `/api/v1/`, `/api/v2/`ï¼‰ã€‚

**é—®é¢˜**: 
- å‰ç«¯éš¾ä»¥ç»Ÿä¸€å¤„ç†å¼‚å¸¸ã€‚
- åŽç«¯ç‰ˆæœ¬è¿­ä»£æ—¶ï¼Œå‰ç«¯å¯èƒ½æ–­è£‚ã€‚
- ç¼ºå°‘æŽ¥å£ç¨³å®šæ€§ä¿è¯ã€‚

**æ–¹æ¡ˆ**:
1. **å®šä¹‰ç»Ÿä¸€çš„å“åº”æ ¼å¼** (åœ¨ `backend/core/response.py` ä¸­)ï¼š
   ```python
   class APIResponse(BaseModel):
       code: int  # 0 = success, 1000+ = errors
       message: str
       data: Any = None
       timestamp: str = Field(default_factory=lambda: datetime.utcnow().isoformat())
   
   # ä½¿ç”¨ç¤ºä¾‹
   def health_check():
       return APIResponse(code=0, message="OK", data={"status": "healthy"})
   ```

2. **å‰åŽç«¯ API ç‰ˆæœ¬åˆ†ç¦»**ï¼š
   - å½“å‰ API æ”¹ä¸º `/api/v1/*`ã€‚
   - æ–°åŠŸèƒ½ä½¿ç”¨ `/api/v2/*`ã€‚
   - è¿‡æœŸ API ä¿ç•™ 2 ä¸ªç‰ˆæœ¬å‘¨æœŸåŽåºŸå¼ƒã€‚

3. **å‰ç«¯ API å®¢æˆ·ç«¯ç»Ÿä¸€** (åœ¨ `frontend/src/api/client.js` ä¸­)ï¼š
   ```javascript
   export const apiClient = {
       get: async (url, options) => { /* ç»Ÿä¸€å¤„ç†å“åº” */ },
       post: async (url, data, options) => { /* ... */ },
       // è‡ªåŠ¨å¤„ç†é”™è¯¯ã€é‡è¯•ã€è¶…æ—¶
   };
   ```

**ä¿®æ”¹æ–‡ä»¶**:
   - æ–°å»º: `backend/core/response.py`ã€`frontend/src/api/client.js`
   - ä¿®æ”¹: æ‰€æœ‰åŽç«¯è·¯ç”±ï¼ˆç»Ÿä¸€å“åº”æ ¼å¼ï¼‰ã€æ‰€æœ‰å‰ç«¯ç»„ä»¶ï¼ˆä½¿ç”¨ç»Ÿä¸€å®¢æˆ·ç«¯ï¼‰

**å®žæ–½æˆæœ¬**: ã€é«˜ã€‘ï¼ˆå…¨é‡åŽç«¯è·¯ç”±æ”¹é€  + å‰ç«¯ç»„ä»¶é‡æž„ï¼‰  
**å½±å“èŒƒå›´**: å…¨éƒ¨ API ç«¯ç‚¹ã€å…¨éƒ¨å‰ç«¯é¡µé¢  
**éªŒè¯æ–¹æ³•**: åœ¨ E2E æµ‹è¯•ä¸­éªŒè¯å“åº”æ ¼å¼ä¸€è‡´æ€§ï¼›ä½¿ç”¨ JSON Schema æ ¡éªŒã€‚

---

### ç¬¬äºŒæ¢¯é˜Ÿï¼šæŽ¨èï¼ˆæœ€ä½³å®žè·µï¼‰

#### 5. è‡ªåŠ¨åŒ–æµ‹è¯•ä¸Žè¦†ç›–ã€ä¼˜å…ˆçº§ï¼šæŽ¨èã€‘
**çŽ°çŠ¶**: 
- `backend/test_smoke.py` å­˜åœ¨ä½†è¦†ç›–çŽ‡ä½Žï¼ˆä»…å†’çƒŸæµ‹è¯•ï¼‰ã€‚
- ç¼ºå°‘å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€E2E æµ‹è¯•çš„æ˜Žç¡®åˆ’åˆ†ã€‚
- å‰ç«¯ Cypress é…ç½®å­˜åœ¨ä½†æœªé›†æˆåˆ° CIã€‚

**æ–¹æ¡ˆ**:
1. **å»ºç«‹æµ‹è¯•ç›®å½•ç»“æž„**ï¼š
   ```
   backend/
   â”œâ”€â”€ tests/
   â”‚   â”œâ”€â”€ unit/         # å•å…ƒæµ‹è¯•
   â”‚   â”œâ”€â”€ integration/  # é›†æˆæµ‹è¯•
   â”‚   â””â”€â”€ conftest.py   # å…±äº« fixtures
   â””â”€â”€ pytest.ini        # å·²å­˜åœ¨
   ```

2. **ä¸ºå…³é”®è·¯ç”±æ·»åŠ æµ‹è¯•**ï¼ˆä¼˜å…ˆçº§ï¼šå¥åº·æ£€æŸ¥ > è®¤è¯ > ä»»åŠ¡æ‰§è¡Œï¼‰ã€‚

3. **åœ¨ CI ä¸­è¿è¡Œ pytest**ï¼š
   ```bash
   pytest --cov=backend --cov-report=html
   ```

**ä¿®æ”¹æ–‡ä»¶**:
   - æ–°å»º: `backend/tests/unit/test_health.py` ç­‰
   - ä¿®æ”¹: `.github/workflows/ci.yml`ï¼ˆæ·»åŠ æµ‹è¯•æ­¥éª¤ï¼‰

**å®žæ–½æˆæœ¬**: ã€ä¸­ã€‘ï¼ˆæµ‹è¯•ä»£ç ç¼–å†™ï¼‰  
**å½±å“èŒƒå›´**: CI/CD æµç¨‹ã€ä»£ç è´¨é‡æŒ‡æ ‡  
**éªŒè¯æ–¹æ³•**: è¿è¡Œ `pytest --cov`ï¼Œç›®æ ‡è¦†ç›–çŽ‡ > 70%ã€‚

---

#### 6. å®¹å™¨åŒ–ä¸Ž CI/CD å®Œå–„ã€ä¼˜å…ˆçº§ï¼šæŽ¨èã€‘
**çŽ°çŠ¶**: 
- `docker/` ä¸‹æœ‰å¤šä¸ª Dockerfileï¼Œä½†ç¼ºå°‘ç»Ÿä¸€çš„ docker-compose ç¼–æŽ’ã€‚
- ç¼ºå°‘å¤šé˜¶æ®µæž„å»ºä¼˜åŒ–ï¼ˆé•œåƒå¤§å°å¯èƒ½å¾ˆå¤§ï¼‰ã€‚
- ç¼ºå°‘ GitHub Actions è‡ªåŠ¨åŒ–æµç¨‹ã€‚

**æ–¹æ¡ˆ**:
1. **ç»Ÿä¸€ docker-compose.yml**ï¼š
   ```yaml
   version: "3.9"
   services:
     backend:
       build:
         context: .
         dockerfile: docker/api.Dockerfile
       ports:
         - "8001:8001"
       environment:
         ENV: production
   
     frontend:
       build:
         context: ./frontend
       ports:
         - "3001:3001"
   
     nginx:
       build:
         context: .
         dockerfile: docker/nginx.Dockerfile
       ports:
         - "80:80"
   ```

2. **åˆ›å»º GitHub Actions å·¥ä½œæµ**ï¼ˆ`.github/workflows/ci.yml`ï¼‰ï¼š
   ```yaml
   name: CI
   on: [push, pull_request]
   jobs:
     test:
       runs-on: ubuntu-latest
       steps:
         - uses: actions/checkout@v3
         - run: ./scripts/test.sh
     build:
       runs-on: ubuntu-latest
       steps:
         - uses: actions/checkout@v3
         - run: docker compose build
   ```

**ä¿®æ”¹æ–‡ä»¶**:
   - æ–°å»º/ä¿®æ”¹: `docker-compose.yml`ã€`.github/workflows/ci.yml`ã€`scripts/test.sh`

**å®žæ–½æˆæœ¬**: ã€ä¸­ã€‘ï¼ˆDocker é…ç½® + CI è„šæœ¬ï¼‰  
**å½±å“èŒƒå›´**: éƒ¨ç½²æµç¨‹ã€CI/CD è‡ªåŠ¨åŒ–  
**éªŒè¯æ–¹æ³•**: æœ¬åœ°è¿è¡Œ `docker compose up`ï¼›åœ¨ GitHub ä¸ŠéªŒè¯ Actions é€šè¿‡ã€‚

---

#### 7. ç›‘æŽ§ã€æ—¥å¿—ä¸Žè‡ªæ„ˆã€ä¼˜å…ˆçº§ï¼šæŽ¨èã€‘
**çŽ°çŠ¶**: 
- `monitoring/` ç›®å½•å­˜åœ¨ä½†é…ç½®ä¸å®Œæ•´ã€‚
- æ—¥å¿—æ•£è½å„åœ°ï¼Œæ— ç»Ÿä¸€æ ¼å¼ã€‚
- ç¼ºå°‘è‡ªåŠ¨å¥åº·æ¢å¤æœºåˆ¶ã€‚

**æ–¹æ¡ˆ**:
1. **ç»Ÿä¸€æ—¥å¿—æ ¼å¼**ï¼ˆJSONï¼‰ï¼š
   ```python
   import logging
   import json
   
   class JsonFormatter(logging.Formatter):
       def format(self, record):
           log_data = {
               "timestamp": datetime.utcnow().isoformat(),
               "level": record.levelname,
               "message": record.getMessage(),
               "module": record.name
           }
           return json.dumps(log_data)
   ```

2. **é…ç½® Prometheus æŒ‡æ ‡å¯¼å‡º**ï¼ˆåœ¨ `backend/app.py` ä¸­ï¼‰ï¼š
   ```python
   from prometheus_client import Counter, Histogram
   
   request_count = Counter('requests_total', 'Total requests', ['method', 'endpoint'])
   request_duration = Histogram('request_duration_seconds', 'Request duration', ['endpoint'])
   
   @app.middleware("http")
   async def log_requests(request, call_next):
       # è®°å½•æŒ‡æ ‡
   ```

3. **è‡ªåŠ¨æ¢å¤è„šæœ¬** (åœ¨ `scripts/auto_heal.sh` ä¸­)ï¼š
   ```bash
   #!/bin/bash
   while true; do
     if ! curl -f http://127.0.0.1:8001/health > /dev/null; then
       echo "Backend down, restarting..."
       pkill -f uvicorn
       sleep 2
       # é‡å¯åŽç«¯
     fi
     sleep 10
   done
   ```

**ä¿®æ”¹æ–‡ä»¶**:
   - æ–°å»º: `backend/core/json_logger.py`ã€`scripts/auto_heal.sh`ã€`monitoring/prometheus.yml`
   - ä¿®æ”¹: `backend/app.py`ï¼ˆé›†æˆæ—¥å¿—ä¸ŽæŒ‡æ ‡ï¼‰

**å®žæ–½æˆæœ¬**: ã€ä¸­ã€‘ï¼ˆæ—¥å¿—æ”¹é€  + æŒ‡æ ‡å¯¼å‡ºï¼‰  
**å½±å“èŒƒå›´**: æ—¥å¿—ç³»ç»Ÿã€ç›‘æŽ§ä¸Žå‘Šè­¦  
**éªŒè¯æ–¹æ³•**: è®¿é—® `http://127.0.0.1:8001/metrics`ï¼Œæ£€æŸ¥ Prometheus æ•°æ®ï¼›æŸ¥çœ‹æ—¥å¿—è¾“å‡ºç¡®ä¿ JSON æ ¼å¼ã€‚

---

### ç¬¬ä¸‰æ¢¯é˜Ÿï¼šå¯é€‰ï¼ˆé”¦ä¸Šæ·»èŠ±ï¼‰

#### 8. æ–‡æ¡£ä¸Žè¿ç»´æ‰‹å†Œã€ä¼˜å…ˆçº§ï¼šå¯é€‰ã€‘
**çŽ°çŠ¶**: 
- `docs/` ä¸‹æœ‰å¤šä»½æ–‡æ¡£ï¼Œä½†ç¼ºå°‘ç»Ÿä¸€çš„å¯¼èˆªã€‚
- README çš„å¿«é€Ÿå¯åŠ¨æ­¥éª¤ä¸Žå®žé™…é…ç½®ä¸åŒæ­¥ã€‚

**æ–¹æ¡ˆ**:
1. **åˆ›å»ºç»Ÿä¸€çš„æ–‡æ¡£å…¥å£** (`docs/index.md`)ã€‚
2. **ç¼–å†™ä¸‰ä¸ªå…³é”®æ‰‹å†Œ**ï¼š
   - `docs/å¿«é€Ÿå¯åŠ¨.md`ï¼š15 åˆ†é’Ÿå¯åŠ¨æœ¬åœ°çŽ¯å¢ƒã€‚
   - `docs/æ•…éšœæŽ’æŸ¥.md`ï¼šå¸¸è§é—®é¢˜ä¸Žè§£å†³æ–¹æ¡ˆã€‚
   - `docs/éƒ¨ç½²è¿ç»´.md`ï¼šç”Ÿäº§çŽ¯å¢ƒéƒ¨ç½²ä¸Žæ‰©å®¹ã€‚

**å®žæ–½æˆæœ¬**: ã€ä½Žã€‘ï¼ˆæ–‡æ¡£ç¼–å†™ï¼‰  
**å½±å“èŒƒå›´**: é¡¹ç›®æ–‡æ¡£  
**éªŒè¯æ–¹æ³•**: æ–°æˆå‘˜æŒ‰æ–‡æ¡£æ­¥éª¤å¯åŠ¨é¡¹ç›®ï¼ŒæˆåŠŸçŽ‡ > 95%ã€‚

---

#### 9. æ’ä»¶ç³»ç»Ÿè§„èŒƒåŒ–ã€ä¼˜å…ˆçº§ï¼šå¯é€‰ã€‘
**çŽ°çŠ¶**: 
- `backend/services/plugin_manager.py` å’Œ `config/plugin_registry.json` å­˜åœ¨ã€‚
- ä½†æ’ä»¶çš„åŠ è½½ã€éªŒè¯ã€éš”ç¦»æœºåˆ¶ä¸æ¸…æ™°ã€‚

**æ–¹æ¡ˆ**:
1. **å®šä¹‰æ’ä»¶æŽ¥å£è§„èŒƒ**ï¼ˆåœ¨ `backend/core/plugin_interface.py` ä¸­ï¼‰ã€‚
2. **ç¼–å†™æ’ä»¶å¼€å‘æŒ‡å—**ï¼ˆåœ¨ `docs/æ’ä»¶å¼€å‘æŒ‡å—.md` ä¸­ï¼‰ã€‚

**å®žæ–½æˆæœ¬**: ã€ä½Žã€‘ï¼ˆæŽ¥å£å®šä¹‰ + æŒ‡å—ç¼–å†™ï¼‰  
**å½±å“èŒƒå›´**: æ’ä»¶ç³»ç»Ÿ  

---

## ðŸ“‹ æ•´ç†ä¼˜åŒ–æ‰§è¡Œæ¸…å•

æŒ‰ä¼˜å…ˆçº§æŽ’åºï¼Œå¯åˆ†é˜¶æ®µæ‰§è¡Œï¼š

### é˜¶æ®µ 1ï¼ˆç¬¬ 1 å‘¨ï¼‰ï¼šè§£å†³å…³é”®é˜»å¡ž
- [ ] **ç¬¬ 1 é¡¹**: å®Œæˆ `backend/requirements.lock` ç”Ÿæˆä¸Žé”å®šã€‚
- [ ] **ç¬¬ 2 é¡¹**: åˆ›å»º `pyproject.toml` ä¸Ž `frontend/.env.example`ã€‚
- [ ] **ç¬¬ 3 é¡¹**: åˆå¹¶ Copilot è§„åˆ™æ–‡ä»¶ï¼Œåˆ é™¤å†—ä½™ã€‚

### é˜¶æ®µ 2ï¼ˆç¬¬ 2-3 å‘¨ï¼‰ï¼šç»Ÿä¸€è§„èŒƒ
- [ ] **ç¬¬ 3 é¡¹**: åˆ›å»ºè·¯ç”±æ³¨å†Œè¡¨ï¼Œç»Ÿä¸€åŽç«¯ APIã€‚
- [ ] **ç¬¬ 4 é¡¹**: å®šä¹‰ç»Ÿä¸€çš„è¯·æ±‚/å“åº”æ ¼å¼ä¸Žç‰ˆæœ¬ç®¡ç†ã€‚
- [ ] **ç¬¬ 5 é¡¹**: æ·»åŠ å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›– > 50%ï¼‰ã€‚

### é˜¶æ®µ 3ï¼ˆç¬¬ 4-5 å‘¨ï¼‰ï¼šå®Œå–„åŸºç¡€è®¾æ–½
- [ ] **ç¬¬ 6 é¡¹**: å®Œå–„å®¹å™¨åŒ–ä¸Ž CI/CDã€‚
- [ ] **ç¬¬ 7 é¡¹**: é…ç½®ç›‘æŽ§ã€æ—¥å¿—ä¸Žè‡ªæ„ˆã€‚

### é˜¶æ®µ 4ï¼ˆç¬¬ 6 å‘¨+ï¼‰ï¼šé”¦ä¸Šæ·»èŠ±
- [ ] **ç¬¬ 8 é¡¹**: ç¼–å†™å®Œæ•´æ–‡æ¡£ä¸Žè¿ç»´æ‰‹å†Œã€‚
- [ ] **ç¬¬ 9 é¡¹**: è§„èŒƒåŒ–æ’ä»¶ç³»ç»Ÿã€‚

---

## âœ… éªŒè¯ä¸Žè´¨é‡ä¿è¯

### è´¨é‡æ£€æŸ¥æ¸…å•
1. **é…ç½®ä¸€è‡´æ€§**
   - [ ] è¿è¡Œ `python3 -m json.tool YL-copilot-rules.json` æ£€æŸ¥ JSON è¯­æ³•ã€‚
   - [ ] éªŒè¯ `pyproject.toml` ä¸Ž `backend/requirements.lock` ç‰ˆæœ¬ä¸€è‡´ã€‚

2. **ä¾èµ–ä¸ŽçŽ¯å¢ƒ**
   - [ ] åœ¨å¹²å‡€çš„ Docker çŽ¯å¢ƒä¸­è¿è¡Œ `pip install -r backend/requirements.lock`ï¼Œæ— ç‰ˆæœ¬å†²çªã€‚
   - [ ] è¿è¡Œ `npm ci` å®‰è£…å‰ç«¯ä¾èµ–ï¼Œæ‰€æœ‰åŒ…åº”æ­£ç¡®å®‰è£…ã€‚

3. **API ä¸Žè·¯ç”±**
   - [ ] è®¿é—® `http://127.0.0.1:8001/docs`ï¼Œæ‰€æœ‰è·¯ç”±åº”æ˜¾ç¤ºã€‚
   - [ ] è¿è¡Œ `scripts/export_openapi.py`ï¼Œç”Ÿæˆ API æ–‡æ¡£æ— é”™è¯¯ã€‚

4. **æµ‹è¯•è¦†ç›–**
   - [ ] è¿è¡Œ `pytest --cov=backend`ï¼Œè¦†ç›–çŽ‡ > 70%ã€‚
   - [ ] æ‰€æœ‰å…³é”®è·¯ç”±ï¼ˆhealthã€authã€pipelineï¼‰åº”æœ‰å¯¹åº”æµ‹è¯•ã€‚

5. **å®¹å™¨åŒ–**
   - [ ] è¿è¡Œ `docker compose build`ï¼Œæ— é”™è¯¯ã€‚
   - [ ] è¿è¡Œ `docker compose up`ï¼ŒåŽç«¯ä¸Žå‰ç«¯åº”æ­£å¸¸å¯åŠ¨ã€‚

6. **æ–‡æ¡£**
   - [ ] æ–°å‘˜å·¥æŒ‰ `docs/å¿«é€Ÿå¯åŠ¨.md` å¯åŠ¨é¡¹ç›®ï¼ŒæˆåŠŸçŽ‡ > 95%ã€‚

---

## ðŸ“ˆ é¢„æœŸæ•ˆæžœ

å®Œæˆæœ¬ä¼˜åŒ–åŽï¼Œé¡¹ç›®å°†è¾¾åˆ°ï¼š

| ç»´åº¦ | æ”¹è¿›å‰ | æ”¹è¿›åŽ | æŒ‡æ ‡ |
|------|--------|--------|------|
| ä¾èµ–ä¸€è‡´æ€§ | ä¸ç¨³å®š | 100% ä¸€è‡´ | é›¶ç‰ˆæœ¬å†²çª |
| API æ–‡æ¡£ | è‡ªåŠ¨ç”Ÿæˆï¼Œæ˜“è¿‡æ—¶ | æ‰‹å·¥ + è‡ªåŠ¨æ··åˆ | > 95% æ–‡æ¡£è¦†ç›– |
| æµ‹è¯•è¦†ç›– | < 30% | > 70% | å…³é”®è·¯å¾„å…¨è¦†ç›– |
| éƒ¨ç½²æ—¶é—´ | 30+ åˆ†é’Ÿ | < 10 åˆ†é’Ÿ | Docker ä¸€é”®å¯åŠ¨ |
| æ–°å‘˜å·¥ä¸Šæ‰‹ | 2-3 å¤© | < 30 åˆ†é’Ÿ | æŒ‰æ–‡æ¡£å¿«é€Ÿå¯åŠ¨ |
| æ•…éšœæ¢å¤ | æ‰‹åŠ¨ | è‡ªåŠ¨ | æ— æ„ŸçŸ¥è‡ªæ„ˆ |

---

## ðŸ”— ç›¸å…³èµ„æº

- **Copilot è§„åˆ™**: [YL-copilot-rules.json](../YL-copilot-rules.json)
- **é¡¹ç›®æ ¹é…ç½®**: å¾…åˆ›å»º `pyproject.toml`
- **API æ–‡æ¡£**: å¾…å®Œå–„ `backend/api/router_registry.py`
- **æµ‹è¯•æ¡†æž¶**: [pytest.ini](../backend/pytest.ini)
- **Docker ç¼–æŽ’**: å¾…å®Œå–„ `docker-compose.yml`

---

## ðŸ“ž åé¦ˆä¸Žè¿­ä»£

æœ¬æŠ¥å‘ŠåŸºäºŽ 2026å¹´1æœˆ7æ—¥çš„é¡¹ç›®æ‰«æç”Ÿæˆã€‚  
å¦‚æœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼Œè¯·æå‡ºï¼Œæˆ‘ä¼šé€æ­¥æ‰§è¡Œä¼˜åŒ–æ–¹æ¡ˆã€‚

