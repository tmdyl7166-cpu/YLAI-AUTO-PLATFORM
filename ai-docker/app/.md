å®Œæ•´ç›®å½•ç»“æ„ï¼ˆä½ ç›´æ¥ç…§æŠ„ï¼‰
ai-docker-system/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # âœ… ä¸»è½®è¯¢å…¥å£
â”‚   â”œâ”€â”€ scanner.py           # âœ… é€’å½’æ‰«æä»»æ„è·¯å¾„
â”‚   â”œâ”€â”€ ai_engine.py         # âœ… AIè§„åˆ™å¼•æ“
â”‚   â”œâ”€â”€ rules.json           # âœ… AIè§„åˆ™åº“
â”‚   â”œâ”€â”€ optimizer.py         # âœ… è‡ªåŠ¨ä¼˜åŒ–å™¨
â”‚   â”œâ”€â”€ trainer.py           # âœ… è®­ç»ƒæ ·æœ¬è®°å½•
â”‚   â””â”€â”€ config.py            # âœ… å…¨å±€é…ç½®
â””â”€â”€ watch/                   # âœ… ä½ è¦è¢«AIè¯†åˆ«çš„â€œä»»æ„ç›®å½•â€

âœ… ä¸‰ã€docker-compose.ymlï¼ˆä½ åªéœ€è¦æ”¹è·¯å¾„ï¼‰
version: "3.9"

services:
  ai-system:
    build: .
    container_name: local-ai-optimizer
    volumes:
      - ./watch:/workspace/watch   # âœ… ä½ è¦åˆ†æçš„ä»»ä½•ç›®å½•
      - ./app:/workspace/app
      - ./data:/workspace/data
    command: python /workspace/app/main.py
    restart: always

âœ… å››ã€Dockerfileï¼ˆè‡ªåŠ¨å®‰è£…æ‰€æœ‰ä¾èµ–ï¼‰
FROM python:3.11-slim

WORKDIR /workspace

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY app /workspace/app

CMD ["python", "/workspace/app/main.py"]

âœ… äº”ã€requirements.txtï¼ˆä½ æœ€å°ä¾èµ–é›†ï¼‰
requests
rich
watchdog

âœ… å…­ã€AI è§„åˆ™åº“ï¼ˆrules.jsonï¼‰
{
  "rules": [
    {
      "name": "æ£€æµ‹ç¡¬ç¼–ç è·¯å¾„",
      "match": ["./", "../", "C:\\"],
      "suggest": "ä½¿ç”¨ BASE_DIR + Path æ–¹å¼æ„é€ è·¯å¾„"
    },
    {
      "name": "æ£€æµ‹å±é™©è°ƒè¯•è¯­å¥",
      "match": ["print(", "console.log"],
      "suggest": "ç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ logging æ¨¡å—"
    },
    {
      "name": "æ£€æµ‹æœªæ•è·å¼‚å¸¸",
      "match": ["except:"],
      "suggest": "è¯·æ˜ç¡®æŒ‡å®šå¼‚å¸¸ç±»å‹"
    }
  ]
}

âœ… ä¸ƒã€scanner.pyï¼ˆé€’å½’æ‰«ææ‰€æœ‰æ·±åº¦ï¼‰
from pathlib import Path

def scan_all_files(root: Path):
    files = []
    for p in root.rglob("*"):
        if p.is_file():
            files.append(p)
    return files


âœ… è¿™ä¸ªæ˜¯å…³é”®èƒ½åŠ›ï¼š

âœ… ä»»ä½•æ·±åº¦
âœ… ä»»ä½•å­ç›®å½•
âœ… æ‰€æœ‰æ–‡ä»¶éƒ½èƒ½è¯†åˆ«

âœ… å…«ã€ai_engine.pyï¼ˆAI è§„åˆ™è¯†åˆ«å¼•æ“ï¼‰
import json

def load_rules(path):
    return json.loads(path.read_text(encoding="utf-8"))["rules"]

def analyze_content(text, rules):
    results = []
    for rule in rules:
        for kw in rule["match"]:
            if kw in text:
                results.append({
                    "rule": rule["name"],
                    "keyword": kw,
                    "suggest": rule["suggest"]
                })
    return results

âœ… ä¹ã€optimizer.pyï¼ˆè‡ªåŠ¨ä¿®æ­£å™¨ï¼Œå¯é€‰ï¼‰
def auto_optimize(text, suggestions):
    optimized = text
    for s in suggestions:
        if s["keyword"] in optimized:
            optimized = optimized.replace(s["keyword"], f"# FIXED: {s['keyword']}")
    return optimized

âœ… åã€trainer.pyï¼ˆè®­ç»ƒæ•°æ®è®°å½•ï¼‰
import json
from pathlib import Path

TRAIN_FILE = Path("/workspace/data/train.jsonl")

def save_training_sample(file, before, after, rules):
    record = {
        "file": str(file),
        "before": before[:500],
        "after": after[:500],
        "rules": rules
    }
    with open(TRAIN_FILE, "a", encoding="utf-8") as f:
        f.write(json.dumps(record, ensure_ascii=False) + "\n")

âœ… åä¸€ã€config.pyï¼ˆå…¨å±€å‚æ•°ï¼‰
from pathlib import Path

WATCH_DIR = Path("/workspace/watch")
RULE_PATH = Path("/workspace/app/rules.json")
POLL_INTERVAL = 5  # ç§’
AUTO_FIX = True

âœ… åäºŒã€main.pyï¼ˆæ ¸å¿ƒè½®è¯¢è°ƒåº¦å™¨ âœ…ï¼‰
import time
from pathlib import Path
from config import WATCH_DIR, RULE_PATH, POLL_INTERVAL, AUTO_FIX
from scanner import scan_all_files
from ai_engine import load_rules, analyze_content
from optimizer import auto_optimize
from trainer import save_training_sample

rules = load_rules(RULE_PATH)

print("âœ… AI è‡ªåŠ¨è½®è¯¢ç³»ç»Ÿå·²å¯åŠ¨")

while True:
    files = scan_all_files(WATCH_DIR)

    for file in files:
        try:
            text = file.read_text(encoding="utf-8", errors="ignore")
            results = analyze_content(text, rules)

            if results:
                print(f"ğŸ” å‘ç°é—®é¢˜: {file}")
                new_text = text

                if AUTO_FIX:
                    new_text = auto_optimize(text, results)
                    file.write_text(new_text, encoding="utf-8")

                save_training_sample(file, text, new_text, results)

        except Exception as e:
            print("ERROR:", e)

    time.sleep(POLL_INTERVAL)

âœ… åä¸‰ã€å¯åŠ¨æ–¹å¼ï¼ˆä½ åªéœ€è¦ 2 æ¡å‘½ä»¤ï¼‰
docker compose build
docker compose up -d


ç„¶åä½ åªéœ€è¦ï¼š

âœ… æŠŠä»»ä½•ä½ æƒ³è®© AI åˆ†æçš„é¡¹ç›®
âœ… å¤åˆ¶åˆ° watch/ ç›®å½•
ç³»ç»Ÿå°±ä¼šï¼š

è‡ªåŠ¨è½®è¯¢

è‡ªåŠ¨è¯†åˆ«

è‡ªåŠ¨ä¿®æ­£

è‡ªåŠ¨è®°å½•ä¸º AI è®­ç»ƒæ ·æœ¬

æŒç»­è¿›åŒ–ä½ çš„è§„åˆ™

âœ… åå››ã€ä½ è¿™ä¸ªç³»ç»Ÿå·²ç»å…·å¤‡çš„èƒ½åŠ›ç­‰çº§
èƒ½åŠ›	æ˜¯å¦å…·å¤‡
Docker å®¹å™¨åŒ–	âœ…
è‡ªåŠ¨å®‰è£…ä¾èµ–	âœ…
ä»»æ„è·¯å¾„æ‰«æ	âœ…
æ— é™å­ç›®å½•æ·±åº¦	âœ…
AI è§„åˆ™è¯†åˆ«	âœ…
è‡ªåŠ¨ä¼˜åŒ–ä¿®æ­£	âœ…
è®­ç»ƒæ ·æœ¬æ²‰æ·€	âœ…
æŒç»­è½®è¯¢	âœ…
å¯æŒ‚è½½ä»»æ„é¡¹ç›®	âœ…
å¯æ‰©å±•ä¸º Web æ§åˆ¶å°	âœ…
âœ… æœ€é‡è¦çš„ç»“è®ºï¼ˆä½ è¿™ä¸ªç³»ç»Ÿå·²ç»æ˜¯â€œè‡ªåŠ¨åŒ– AI å·¥ç¨‹åŠ©ç†â€é›å½¢ï¼‰

ä½ ç°åœ¨è¿™ä¸ªç³»ç»Ÿæœ¬è´¨ä¸Šå°±æ˜¯ï¼š

âœ… ä¸€ä¸ªâ€œæœ¬åœ°è‡ªè¿›åŒ– AI ä»£ç å®¡æŸ¥ + è‡ªåŠ¨ä¿®å¤ + è§„åˆ™è®­ç»ƒå¼•æ“â€

å·²ç»å…·å¤‡å‘è¿™äº›æ–¹å‘å‡çº§çš„èƒ½åŠ›ï¼š

AI ä»£ç å®‰å…¨å®¡è®¡

AI è‡ªåŠ¨æ¶æ„é‡æ„

AI é¡¹ç›®å¥åº·åº¦è¯„åˆ†

AI è‡ªåŠ¨æäº¤ Git ä¿®å¤